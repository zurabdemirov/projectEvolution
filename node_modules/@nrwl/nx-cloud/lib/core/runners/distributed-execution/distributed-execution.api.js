const a10_0x53e4=['done','map','__awaiter','response','exit','project','apply','completeRunGroup','__esModule','RUNNER_FAILURE_PERF_ENTRY','next','axiosException','serializeOverrides','stopAgentsOnFailure','then','maxParallel','ciExecutionEnv:\x20','../../../utilities/environment','runGroup:\x20','DistributedExecutionApi','Completing\x20with\x20an\x20error','parseCommand','VERBOSE_LOGGING','data','status','value','../../../utilities/nx-imports','ciExecutionId:\x20','createMetricRecorder','note','axiosMultipleTries','throw','/nx-cloud/executions/status','false','parallel','mapRespToPerfEntry','Workspace\x20is\x20disabled.\x20Cannot\x20perform\x20distributed\x20task\x20executions.','configuration','error','recordMetric','NX_CLOUD_DISTRIBUTED_EXECUTION_STOP_AGENTS_ON_FAILURE','true','stringify','completeRunGroupWithError','/nx-cloud/executions/complete-run-group','apiAxiosInstance','error:\x20','createApiAxiosInstance','../../../utilities/serializer-overrides','NX_CLOUD_DISTRIBUTED_EXECUTION_AGENT_COUNT','target','post','enabled'];(function(_0x3de0ce,_0x53e487){const _0x44f269=function(_0x34ca37){while(--_0x34ca37){_0x3de0ce['push'](_0x3de0ce['shift']());}};_0x44f269(++_0x53e487);}(a10_0x53e4,0x168));const a10_0x44f2=function(_0x3de0ce,_0x53e487){_0x3de0ce=_0x3de0ce-0x0;let _0x44f269=a10_0x53e4[_0x3de0ce];return _0x44f269;};'use strict';var __awaiter=this&&this[a10_0x44f2('0xd')]||function(_0x51be29,_0x84f687,_0x6d0736,_0x515f68){function _0x3d4496(_0x5a399e){return _0x5a399e instanceof _0x6d0736?_0x5a399e:new _0x6d0736(function(_0x54616){_0x54616(_0x5a399e);});}return new(_0x6d0736||(_0x6d0736=Promise))(function(_0x24c337,_0x1f50f7){function _0x50609d(_0x41583a){try{_0xad1e92(_0x515f68[a10_0x44f2('0x15')](_0x41583a));}catch(_0x4737bb){_0x1f50f7(_0x4737bb);}}function _0x3dd67d(_0x580cae){try{_0xad1e92(_0x515f68[a10_0x44f2('0x2a')](_0x580cae));}catch(_0x49d479){_0x1f50f7(_0x49d479);}}function _0xad1e92(_0x35ebc9){_0x35ebc9[a10_0x44f2('0xb')]?_0x24c337(_0x35ebc9[a10_0x44f2('0x24')]):_0x3d4496(_0x35ebc9['value'])[a10_0x44f2('0x19')](_0x50609d,_0x3dd67d);}_0xad1e92((_0x515f68=_0x515f68[a10_0x44f2('0x11')](_0x51be29,_0x84f687||[]))[a10_0x44f2('0x15')]());});};Object['defineProperty'](exports,a10_0x44f2('0x13'),{'value':!![]});exports['createStartRequest']=exports[a10_0x44f2('0x1e')]=void 0x0;const axios_1=require('../../../utilities/axios');const environment_1=require(a10_0x44f2('0x1c'));const metric_logger_1=require('../../../utilities/metric-logger');const serializer_overrides_1=require(a10_0x44f2('0x6'));const {output}=require(a10_0x44f2('0x25'));class DistributedExecutionApi{constructor(_0x154685){this[a10_0x44f2('0x3')]=(0x0,axios_1[a10_0x44f2('0x5')])(_0x154685);}['start'](_0x49b7d5){var _0x160812;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x36783f=(0x0,metric_logger_1[a10_0x44f2('0x27')])('dteStart');let _0x4c2c8c;if(environment_1[a10_0x44f2('0x21')]){output[a10_0x44f2('0x28')]({'title':'Starting\x20a\x20distributed\x20execution','bodyLines':[JSON[a10_0x44f2('0x0')](_0x49b7d5,null,0x2)]});}try{_0x4c2c8c=yield(0x0,axios_1['axiosMultipleTries'])(()=>this[a10_0x44f2('0x3')]['post']('/nx-cloud/executions/start',_0x49b7d5));_0x36783f[a10_0x44f2('0x32')]((0x0,metric_logger_1[a10_0x44f2('0x2e')])(_0x4c2c8c));}catch(_0x2cbc18){_0x36783f[a10_0x44f2('0x32')](((_0x160812=_0x2cbc18===null||_0x2cbc18===void 0x0?void 0x0:_0x2cbc18[a10_0x44f2('0x16')])===null||_0x160812===void 0x0?void 0x0:_0x160812[a10_0x44f2('0xe')])?(0x0,metric_logger_1[a10_0x44f2('0x2e')])(_0x2cbc18[a10_0x44f2('0x16')]['response']):metric_logger_1['RUNNER_FAILURE_PERF_ENTRY']);throw _0x2cbc18;}if(!_0x4c2c8c['data'][a10_0x44f2('0xa')]){throw new Error(a10_0x44f2('0x2f'));}if(_0x4c2c8c[a10_0x44f2('0x22')][a10_0x44f2('0x31')]){throw new Error(_0x4c2c8c[a10_0x44f2('0x22')][a10_0x44f2('0x31')]);}return _0x4c2c8c[a10_0x44f2('0x22')]['id'];});}[a10_0x44f2('0x23')](_0x2ec1fd){var _0x29fad5;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x375cf2=(0x0,metric_logger_1[a10_0x44f2('0x27')])('dteStatus');try{const _0x169133=yield(0x0,axios_1[a10_0x44f2('0x29')])(()=>this['apiAxiosInstance'][a10_0x44f2('0x9')](a10_0x44f2('0x2b'),{'id':_0x2ec1fd}));_0x375cf2[a10_0x44f2('0x32')]((0x0,metric_logger_1[a10_0x44f2('0x2e')])(_0x169133));return _0x169133[a10_0x44f2('0x22')];}catch(_0x1617d2){_0x375cf2[a10_0x44f2('0x32')](((_0x29fad5=_0x1617d2===null||_0x1617d2===void 0x0?void 0x0:_0x1617d2[a10_0x44f2('0x16')])===null||_0x29fad5===void 0x0?void 0x0:_0x29fad5[a10_0x44f2('0xe')])?(0x0,metric_logger_1[a10_0x44f2('0x2e')])(_0x1617d2['axiosException'][a10_0x44f2('0xe')]):metric_logger_1[a10_0x44f2('0x14')]);output[a10_0x44f2('0x31')]({'title':_0x1617d2['message']});process[a10_0x44f2('0xf')](0x1);}});}[a10_0x44f2('0x1')](_0x246684,_0x33170d,_0x307921,_0x5eaa27,_0x589d0c){var _0x468f99;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x53566d=(0x0,metric_logger_1[a10_0x44f2('0x27')])(a10_0x44f2('0x12'));if(environment_1[a10_0x44f2('0x21')]){output[a10_0x44f2('0x28')]({'title':a10_0x44f2('0x1f'),'bodyLines':[a10_0x44f2('0x26')+_0x307921,a10_0x44f2('0x1b')+_0x5eaa27,a10_0x44f2('0x1d')+_0x33170d,a10_0x44f2('0x4')+_0x589d0c]});}try{const _0x3ec3f0=yield(0x0,axios_1[a10_0x44f2('0x29')])(()=>this[a10_0x44f2('0x3')][a10_0x44f2('0x9')](a10_0x44f2('0x2'),{'runGroup':_0x33170d,'ciExecutionId':_0x307921,'ciExecutionEnv':_0x5eaa27,'criticalErrorMessage':_0x589d0c}),0x3);_0x53566d['recordMetric']((0x0,metric_logger_1[a10_0x44f2('0x2e')])(_0x3ec3f0));}catch(_0x3af4ea){_0x53566d[a10_0x44f2('0x32')](((_0x468f99=_0x3af4ea===null||_0x3af4ea===void 0x0?void 0x0:_0x3af4ea['axiosException'])===null||_0x468f99===void 0x0?void 0x0:_0x468f99[a10_0x44f2('0xe')])?(0x0,metric_logger_1[a10_0x44f2('0x2e')])(_0x3af4ea['axiosException'][a10_0x44f2('0xe')]):metric_logger_1[a10_0x44f2('0x14')]);}});}}exports[a10_0x44f2('0x1e')]=DistributedExecutionApi;function createStartRequest(_0x461f23,_0x4b267f,_0x479043,_0xb3fbbf,_0x12009d,_0x309b57){const _0xbd8964=_0x12009d[a10_0x44f2('0xc')](_0x415651=>{return _0x415651[a10_0x44f2('0xc')](_0x243649=>{return{'taskId':_0x243649['id'],'hash':_0x243649['hash'],'projectName':_0x243649[a10_0x44f2('0x8')][a10_0x44f2('0x10')],'target':_0x243649[a10_0x44f2('0x8')][a10_0x44f2('0x8')],'configuration':_0x243649['target'][a10_0x44f2('0x30')]||null,'params':(0x0,serializer_overrides_1[a10_0x44f2('0x17')])(_0x243649)};});});const _0x40acaf={'command':(0x0,environment_1[a10_0x44f2('0x20')])(),'branch':_0x461f23,'runGroup':_0x4b267f,'ciExecutionId':_0x479043,'ciExecutionEnv':_0xb3fbbf,'tasks':_0xbd8964,'maxParallel':calculateMaxParallel(_0x309b57)};if(environment_1[a10_0x44f2('0x7')]){_0x40acaf['agentCount']=environment_1[a10_0x44f2('0x7')];}if(!environment_1[a10_0x44f2('0x33')]){_0x40acaf[a10_0x44f2('0x18')]=![];}return _0x40acaf;}exports['createStartRequest']=createStartRequest;function calculateMaxParallel(_0x18ba38){if(_0x18ba38['parallel']===a10_0x44f2('0x2c')||_0x18ba38['parallel']===![]){return 0x1;}else if(_0x18ba38[a10_0x44f2('0x2d')]===a10_0x44f2('0x34')||_0x18ba38[a10_0x44f2('0x2d')]===!![]){return Number(_0x18ba38[a10_0x44f2('0x1a')]||0x3);}else if(_0x18ba38[a10_0x44f2('0x2d')]===undefined){return _0x18ba38[a10_0x44f2('0x1a')]?Number(_0x18ba38[a10_0x44f2('0x1a')]):0x3;}else{return Number(_0x18ba38[a10_0x44f2('0x2d')])||0x3;}}