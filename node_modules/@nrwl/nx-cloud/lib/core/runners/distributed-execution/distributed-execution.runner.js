const a11_0x422e=['warn','DteArtifactStorage','printRunGroupError','exit','endTasks','completeRunGroupWithError','getCIExecutionId','DTE\x20needs\x20the\x20cache\x20to\x20share\x20files\x20between\x20agents.','FileStorage','commandStatus','./process-tasks','success','../../file-storage/e2e-encryption','done','Command\x20execution\x20failed.','splitTasksIntoStages','start','throw','startTask','getNxCacheDirectory','apply','./distributed-execution.api','taskGraph','next','../../error/print-run-group-error','../../../utilities/nx-imports','../../api/error-reporter.api','VERBOSE_LOGGING','../../../utilities/environment','skipNxCache','scheduleTask','dte-main','../../../utilities/dte-artifact-storage','then','error','values','lifeCycle','createTaskGraphCompat','defineProperty','message','value','getCIExecutionEnv','note','axiosException','getBranch','submitRunMetrics','tasks','encryptionKey','runUrl','Main\x20job\x20was\x20terminated\x20via\x20SIGINT','SIGTERM','Main\x20job\x20terminated\x20with\x20an\x20error:\x20\x22','--skip-nx-cache\x20is\x20ignored\x20when\x20using\x20distributed\x20tasks\x20execution\x20(DTE).','nxCloudDistributedTasksRunner','ErrorReporterApi','../../file-storage/file-storage','See\x20run\x20details\x20at\x20','log','getRunGroup','Unable\x20to\x20complete\x20a\x20run.','../../../utilities/metric-logger','createStartRequest'];(function(_0x508478,_0x422ea2){const _0x48e5ac=function(_0x5d775a){while(--_0x5d775a){_0x508478['push'](_0x508478['shift']());}};_0x48e5ac(++_0x422ea2);}(a11_0x422e,0x1b6));const a11_0x48e5=function(_0x508478,_0x422ea2){_0x508478=_0x508478-0x0;let _0x48e5ac=a11_0x422e[_0x508478];return _0x48e5ac;};'use strict';var __awaiter=this&&this['__awaiter']||function(_0x56b720,_0x9d4598,_0x38f138,_0x389fde){function _0x367635(_0x19a31e){return _0x19a31e instanceof _0x38f138?_0x19a31e:new _0x38f138(function(_0x2e79c6){_0x2e79c6(_0x19a31e);});}return new(_0x38f138||(_0x38f138=Promise))(function(_0x4ac38c,_0x255fa2){function _0x57e2d4(_0x3dc758){try{_0x486fd8(_0x389fde[a11_0x48e5('0x13')](_0x3dc758));}catch(_0x13b3ba){_0x255fa2(_0x13b3ba);}}function _0x5a03b3(_0x3bc1c4){try{_0x486fd8(_0x389fde[a11_0x48e5('0xd')](_0x3bc1c4));}catch(_0x11e43c){_0x255fa2(_0x11e43c);}}function _0x486fd8(_0x3f8f73){_0x3f8f73[a11_0x48e5('0x9')]?_0x4ac38c(_0x3f8f73[a11_0x48e5('0x24')]):_0x367635(_0x3f8f73['value'])[a11_0x48e5('0x1d')](_0x57e2d4,_0x5a03b3);}_0x486fd8((_0x389fde=_0x389fde[a11_0x48e5('0x10')](_0x56b720,_0x9d4598||[]))[a11_0x48e5('0x13')]());});};Object[a11_0x48e5('0x22')](exports,'__esModule',{'value':!![]});exports[a11_0x48e5('0x31')]=void 0x0;const environment_1=require(a11_0x48e5('0x18'));const metric_logger_1=require(a11_0x48e5('0x38'));const error_reporter_api_1=require(a11_0x48e5('0x16'));const print_run_group_error_1=require(a11_0x48e5('0x14'));const e2e_encryption_1=require(a11_0x48e5('0x8'));const file_storage_1=require(a11_0x48e5('0x33'));const distributed_execution_api_1=require(a11_0x48e5('0x11'));const split_task_graph_into_stages_1=require('./split-task-graph-into-stages');const task_graph_creator_1=require('./task-graph-creator');const process_tasks_1=require(a11_0x48e5('0x6'));const dte_artifact_storage_1=require(a11_0x48e5('0x1c'));const {output}=require(a11_0x48e5('0x15'));class NoopLifeCycle{[a11_0x48e5('0x1a')](_0x4b4bc1){}[a11_0x48e5('0xe')](_0x16c63b){}[a11_0x48e5('0x0')](_0x3ada1e){}}const nxCloudDistributedTasksRunner=(_0x3c204b,_0x14e6ca,_0x34583a)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){if(_0x14e6ca[a11_0x48e5('0x19')]){output[a11_0x48e5('0x3a')]({'title':a11_0x48e5('0x30'),'bodyLine':[a11_0x48e5('0x3')]});}if(environment_1[a11_0x48e5('0x17')]){output[a11_0x48e5('0x26')]({'title':'Starting\x20distributed\x20command\x20execution'});}_0x14e6ca[a11_0x48e5('0x20')]=new NoopLifeCycle();const _0x29be15=(0x0,environment_1[a11_0x48e5('0x28')])();const _0x35b73e=(0x0,environment_1[a11_0x48e5('0x36')])();const _0x21c9c2=(0x0,environment_1[a11_0x48e5('0x2')])();const _0x255308=(0x0,environment_1[a11_0x48e5('0x25')])();if(!(0x0,print_run_group_error_1['canDetectRunGroup'])(_0x35b73e,_0x21c9c2)){(0x0,print_run_group_error_1[a11_0x48e5('0x3c')])();process['exit'](0x1);}const _0x21b08e=new e2e_encryption_1['E2EEncryption'](environment_1['ENCRYPTION_KEY']||_0x14e6ca[a11_0x48e5('0x2b')]);const _0x27a3c5=new error_reporter_api_1[(a11_0x48e5('0x32'))](_0x14e6ca);const _0xb0d6a2=new dte_artifact_storage_1[(a11_0x48e5('0x3b'))](new file_storage_1[(a11_0x48e5('0x4'))](_0x21b08e,_0x27a3c5,_0x14e6ca,a11_0x48e5('0x1b')),(0x0,environment_1[a11_0x48e5('0xf')])(_0x14e6ca));const _0x7b75fe=new distributed_execution_api_1['DistributedExecutionApi'](_0x14e6ca);attachSignalListenersToCompleteRunGroupOnError(_0x7b75fe,_0x29be15,_0x35b73e,_0x21c9c2,_0x255308);try{const _0x409bdf=getTaskGraph(_0x34583a,_0x3c204b,_0x14e6ca);const _0x1b06dd=yield runDistributedExecution(_0x7b75fe,_0x14e6ca,_0xb0d6a2,_0x29be15,_0x35b73e,_0x21c9c2,_0x255308,_0x409bdf);if(_0x1b06dd['commandStatus']===0x0){output[a11_0x48e5('0x7')]({'title':'Successfully\x20completed\x20running\x20the\x20command.','bodyLines':['See\x20run\x20details\x20at\x20'+_0x1b06dd[a11_0x48e5('0x2c')]]});}else{output[a11_0x48e5('0x1e')]({'title':a11_0x48e5('0xa'),'bodyLines':[a11_0x48e5('0x34')+_0x1b06dd[a11_0x48e5('0x2c')]]});}yield(0x0,metric_logger_1[a11_0x48e5('0x29')])(_0x14e6ca);process[a11_0x48e5('0x3d')](_0x1b06dd[a11_0x48e5('0x5')]);}catch(_0x8ad5cf){output[a11_0x48e5('0x1e')]({'title':a11_0x48e5('0x37'),'bodyLines':[_0x8ad5cf[a11_0x48e5('0x23')]]});if(_0x8ad5cf[a11_0x48e5('0x27')]){console[a11_0x48e5('0x35')](_0x8ad5cf[a11_0x48e5('0x27')]);}else{console[a11_0x48e5('0x35')](_0x8ad5cf);}try{yield _0x7b75fe[a11_0x48e5('0x1')](_0x29be15,_0x35b73e,_0x21c9c2,_0x255308,a11_0x48e5('0x2f')+_0x8ad5cf[a11_0x48e5('0x23')]+'\x22');}finally{process[a11_0x48e5('0x3d')](0x1);}}});exports[a11_0x48e5('0x31')]=nxCloudDistributedTasksRunner;function getTaskGraph(_0x25fff3,_0x3e6c4c,_0x267a33){if(_0x25fff3[a11_0x48e5('0x12')]){return _0x25fff3[a11_0x48e5('0x12')];}else{return(0x0,task_graph_creator_1[a11_0x48e5('0x21')])(_0x267a33,_0x25fff3['projectGraph'],_0x3e6c4c);}}function attachSignalListenersToCompleteRunGroupOnError(_0x4c192a,_0xea9f84,_0x2aa79a,_0x31bc43,_0x40c202){process['on']('SIGINT',()=>__awaiter(this,void 0x0,void 0x0,function*(){yield _0x4c192a[a11_0x48e5('0x1')](_0xea9f84,_0x2aa79a,_0x31bc43,_0x40c202,a11_0x48e5('0x2d'));process[a11_0x48e5('0x3d')](0x1);}));process['on'](a11_0x48e5('0x2e'),()=>__awaiter(this,void 0x0,void 0x0,function*(){yield _0x4c192a[a11_0x48e5('0x1')](_0xea9f84,_0x2aa79a,_0x31bc43,_0x40c202,'Main\x20job\x20was\x20terminated\x20via\x20SIGTERM');process[a11_0x48e5('0x3d')](0x1);}));}function runDistributedExecution(_0x49afd5,_0x531869,_0x3f952f,_0x449c7e,_0x3c7625,_0x3f2361,_0x30e4ba,_0x398cd7){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x289248=yield _0x49afd5[a11_0x48e5('0xc')]((0x0,distributed_execution_api_1[a11_0x48e5('0x39')])(_0x449c7e,_0x3c7625,_0x3f2361,_0x30e4ba,(0x0,split_task_graph_into_stages_1[a11_0x48e5('0xb')])(_0x398cd7),_0x531869));return yield(0x0,process_tasks_1['processTasks'])(_0x49afd5,_0x3f952f,_0x289248,Object[a11_0x48e5('0x1f')](_0x398cd7[a11_0x48e5('0x2a')]));});}